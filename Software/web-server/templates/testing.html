{% extends "base.html" %}

{% block title %}Testing Tools - PiTrac{% endblock %}
{% block page_title %}Testing Tools{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/testing.css">
{% endblock %}

{% block content %}
<!-- Main Content -->
<div class="main-content">
    <div class="testing-container">

    <!-- Image Upload Section -->
    <div class="tool-category">
        <h2 class="category-title">
            <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
            </svg>
            Image Pipeline Testing
        </h2>
        <div class="image-upload-container">
            <div class="upload-area" id="uploadArea">
                <svg fill="currentColor" viewBox="0 0 20 20" width="48" height="48">
                    <path d="M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z"/>
                </svg>
                <p>Drag and drop flight camera image here</p>
                <p class="upload-hint">or click to browse</p>
                <input type="file" id="imageUpload" accept="image/*" style="display: none;">
            </div>
            <div id="imagePreview" style="display: none;">
                <img id="previewImg" alt="Preview">
                <div class="image-info">
                    <span id="imageName"></span>
                    <button class="btn btn-danger btn-sm" onclick="clearImage()">Remove</button>
                </div>
            </div>
            <button id="runPipelineBtn" class="btn btn-primary btn-lg" style="display: none;" onclick="runImageTest()">
                Run Full Pipeline Test
            </button>
        </div>
    </div>

    <!-- Tool Categories -->
    <div class="tool-categories">
        <!-- Hardware Tests -->
        <div class="tool-category">
            <h2 class="category-title">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"/>
                </svg>
                Hardware Tests
            </h2>
            <div class="tool-grid" id="hardware-tools">
                <!-- Tools will be populated by JavaScript -->
            </div>
        </div>

        <!-- Camera Tests -->
        <div class="tool-category">
            <h2 class="category-title">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.414-1.414A1 1 0 0011.586 3H8.414a1 1 0 00-.707.293L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                </svg>
                Camera Tests
            </h2>
            <div class="tool-grid" id="camera-tools">
                <!-- Tools will be populated by JavaScript -->
            </div>
        </div>

        <!-- Calibration Tests -->
        <div class="tool-category">
            <h2 class="category-title">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                </svg>
                Calibration Tests
            </h2>
            <div class="tool-grid" id="calibration-tools">
                <!-- Tools will be populated by JavaScript -->
            </div>
        </div>

        <!-- Testing Suite -->
        <div class="tool-category">
            <h2 class="category-title">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V4a2 2 0 00-2-2H6zm1 2a1 1 0 000 2h6a1 1 0 100-2H7zm6 7a1 1 0 011 1v3a1 1 0 11-2 0v-3a1 1 0 011-1zm-3 3a1 1 0 100 2h.01a1 1 0 100-2H10zm-4 1a1 1 0 011-1h.01a1 1 0 110 2H7a1 1 0 01-1-1z" clip-rule="evenodd"/>
                </svg>
                Testing Suite
            </h2>
            <div class="tool-grid" id="testing-tools">
                <!-- Tools will be populated by JavaScript -->
            </div>
        </div>

        <!-- Connectivity Tests -->
        <div class="tool-category">
            <h2 class="category-title">
                <svg fill="currentColor" viewBox="0 0 20 20" width="20" height="20">
                    <path fill-rule="evenodd" d="M12.293 1.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 7H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414zM3 11a1 1 0 011-1h11.586l-2.293-2.293a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 13H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                </svg>
                Connectivity Tests
            </h2>
            <div class="tool-grid" id="connectivity-tools">
                <!-- Tools will be populated by JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Output Panel -->
    <div class="output-panel">
        <div class="output-header">
            <h3>Test Output</h3>
            <button class="btn btn-secondary" onclick="clearOutput()">Clear</button>
        </div>
        <div class="output-content" id="testOutput">
            <div class="output-placeholder">Select a test tool to see output here</div>
        </div>
    </div>
    </div>
</div>

<!-- Test Result Modal -->
<div id="testModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <h2 id="modalTitle">Test Result</h2>
        <div id="modalBody"></div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/testing.js"></script>
{% endblock %}